const datePicker=document.getElementById("datepicker"),timePicker=document.getElementById("timepicker");function getWeekNumber(date=new Date){date.setHours(0,0,0,0),date.setDate(date.getDate()+3-(date.getDay()+6)%7);const week1=new Date(date.getFullYear(),0,4);return Math.round((date.getTime()-week1.getTime())/864e5-3+(week1.getDay()+6)%7)/7+1}function getWeekDates(date=new Date){date.setHours(0,0,0,0);const isoDay=(date.getDay()+6)%7;date.setDate(date.getDate()-isoDay);const weekDates=[];for(let i=0;i<7;i++){const d=new Date(date);d.setDate(date.getDate()+i),weekDates.push(d.getDate()+". "+d.toLocaleString("default",{month:"short"}))}return weekDates}function renderWeek(date,setDatePicker=!0){if(setDatePicker){const oneDayAhead=new Date(date);oneDayAhead.setDate(oneDayAhead.getDate()+1),oneDayAhead.setHours(13,0,0,0);flatpickr(datePicker,{locale:"da",dateFormat:"d-m-Y",weekNumbers:!0,minDate:"today"}).setDate(oneDayAhead);flatpickr(timePicker,{locale:"da",enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0,minTime:"08:00",maxTime:"17:00"}).setDate(oneDayAhead)}document.querySelector(".your-booking")&&addYourTimeKaldender(0),document.getElementById("week").textContent="Uge "+getWeekNumber(date),getWeekDates(date).forEach(((day,index)=>{document.getElementById("date"+index).textContent=day}))}function addService(service){const selectedServices=document.getElementById("selected_services_list"),newService=document.createElement("div");newService.classList.add("serviceitem"),selectedServices.appendChild(newService);const service_label=service.split("%")[0],service_duration=Number(service.split("%")[1]),service_price=service.split("%")[2],service_price_formated=Number(service_price).toLocaleString("de-DE"),service_andtal_personer=Number(service.split("%")[3]),service_andtal_personer_formated=service_andtal_personer<=1?service_andtal_personer+" person":service_andtal_personer+" personer",service_inkl=service.split("%")[4],icon=document.createElement("span");icon.innerHTML='<svg width="20" height="20" viewBox="0 0 17 17" xmlns="http://www.w3.org/2000/svg"><path d="M5.33887 14.7065C4.9722 14.7065 4.65831 14.576 4.3972 14.3149C4.13609 14.0538 4.00553 13.7399 4.00553 13.3732V4.70654H3.33887V3.37321H6.6722V2.70654H10.6722V3.37321H14.0055V4.70654H13.3389V13.3732C13.3389 13.7399 13.2083 14.0538 12.9472 14.3149C12.6861 14.576 12.3722 14.7065 12.0055 14.7065H5.33887ZM12.0055 4.70654H5.33887V13.3732H12.0055V4.70654ZM6.6722 12.0399H8.00553V6.03988H6.6722V12.0399ZM9.33887 12.0399H10.6722V6.03988H9.33887V12.0399Z"/></svg>',icon.addEventListener("click",(()=>{newService.remove(),addYourTimeKaldender(-service_duration)})),newService.innerHTML='<div class="service-top"><span class="service">'+service_label+'</span><span class="price">'+service_price_formated+' Kr.</span></div><div class="service-bottom"><div class="genneral-info"><span>Servicen g√¶lder '+service_andtal_personer_formated+"</span><span>Inkl. "+service_inkl+'</span></div> <div><span class="duration">'+service_duration+" min</span></div></div>";newService.querySelector(".service-top").appendChild(icon),addYourTimeKaldender(service_duration)}function stringToDateObject(dateStr){const[datePart,timePart]=dateStr.split(" "),[day,month,year]=datePart.split("-"),[hour,minute]=timePart.split(":");return new Date(year,month-1,day,hour,minute)}document.addEventListener("DOMContentLoaded",(()=>{const prevArrow=document.getElementById("prev_week");prevArrow.classList.add("arrow-disabled");const nextArrow=document.getElementById("next_week");let currentDate=new Date;const servicePicker=document.getElementById("add_services");renderWeek(currentDate),renderServiceOptions(),nextArrow.addEventListener("click",(()=>{prevArrow.classList.contains("arrow-disabled")&&prevArrow.classList.remove("arrow-disabled"),currentDate.setDate(currentDate.getDate()+7),renderWeek(currentDate)})),prevArrow.addEventListener("click",(()=>{currentDate.setDate(currentDate.getDate()-7),currentDate<new Date&&(currentDate=new Date,prevArrow.classList.add("arrow-disabled")),renderWeek(currentDate)})),timePicker.addEventListener("change",(()=>{const selectedDate=new Date(stringToDateObject(datePicker.value+" "+timePicker.value));currentDate=selectedDate,renderWeek(currentDate,!1)})),datePicker.addEventListener("change",(()=>{const selectedDate=new Date(stringToDateObject(datePicker.value+" "+timePicker.value));currentDate=selectedDate,renderWeek(currentDate,!1)})),servicePicker.addEventListener("change",(()=>{addService(servicePicker.value),servicePicker.value="default"}));document.getElementById("go_to_booking").addEventListener("click",(event=>{event.preventDefault(),validateBooking()?(localStorage.setItem("selectedservices",JSON.stringify(getSelectedServices())),window.location="booking2.html"):alert("Denne tid eller noget af denne tid er allerede booket")}))}));var TotalTimeOfYourBooking=0;function addYourTimeKaldender(time){TotalTimeOfYourBooking+=time;const dateName=stringToDateObject(datePicker.value+" "+timePicker.value).toLocaleDateString("en-US",{weekday:"long"}),yourTime=document.querySelector(".your-booking");yourTime&&yourTime.remove(),addTimeToKaldender(dateName.toLocaleLowerCase(),timePicker.value,TotalTimeOfYourBooking,!0)}function addTimeToKaldender(day,strattime,lenght,yourBokking=!1){const column=document.querySelector("."+day+" .showen-time"),sizeRatio=column.getBoundingClientRect().height/10,time=document.createElement("div");time.classList.add("booking-time"),yourBokking&&(time.classList.add("your-booking"),time.textContent="Din tid"),time.style.top=(strattime.split(":")[0]-8+strattime.split(":")[1]/60)*sizeRatio+"px",time.style.height=lenght/60*sizeRatio+"px",lenght>0&&column.appendChild(time)}function getSelectedServices(){const selectedServices={};selectedServices.datetime=datePicker.value+" "+timePicker.value;var totalPrice=0;return selectedServices.services=[],document.querySelectorAll("#selected_services_list .serviceitem").forEach(((service,index)=>{const name=service.querySelector(".service").textContent,time=Number(service.querySelector(".duration").textContent.split(" ")[0]),price=Number(service.querySelector(".price").textContent.replace(".","").split(" ")[0]),serviceObject={};serviceObject["service"+index]=name,serviceObject["tid"+index]=time,serviceObject["pris"+index]=price,totalPrice+=price,selectedServices.services.push(serviceObject)})),selectedServices.totalTime=TotalTimeOfYourBooking,selectedServices.totalPrice=totalPrice,selectedServices}function validateBooking(){return!0}function renderServiceOptions(){const selector=document.getElementById("add_services");fetch("pakker.json").then((response=>response.json())).then((data=>{data.forEach((service=>{const option=document.createElement("option");option.value=service.label+"%"+service.duration+"%"+service.price+"%"+service.andtal_personer+"%"+service.inkl,option.textContent=service.label,selector.appendChild(option)}))}))}